<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>MySQL管理和语法 | 三月三</title><meta name="description" content="3.1 SQL 语言概述一、SQL 具有四个主要的功能SQL 有两种使用方法 :              交互式 SQL: 一种与用户交互的方式，适合非计算机专业人员。 宿主型 SQL: 一种作为子语言嵌入到其它程序设计语言中，适合于程序设计人员用高级语言编写应用程序并与数据库打交道 , 嵌入到主语言中使用。  主要功能:             数据定义（ DDL）:主要用于创建、修改、删除数"><meta name="keywords" content="MySQL"><meta name="author" content="三月三"><meta name="copyright" content="三月三"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://hm.baidu.com"/><link rel="dns-prefetch" href="https://hm.baidu.com"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="MySQL管理和语法"><meta name="twitter:description" content="3.1 SQL 语言概述一、SQL 具有四个主要的功能SQL 有两种使用方法 :              交互式 SQL: 一种与用户交互的方式，适合非计算机专业人员。 宿主型 SQL: 一种作为子语言嵌入到其它程序设计语言中，适合于程序设计人员用高级语言编写应用程序并与数据库打交道 , 嵌入到主语言中使用。  主要功能:             数据定义（ DDL）:主要用于创建、修改、删除数"><meta name="twitter:image" content="http://cdn.panyucable.cn/zysheep/mysql_PNG32.png"><meta property="og:type" content="article"><meta property="og:title" content="MySQL管理和语法"><meta property="og:url" content="https://zysheep.cn/2018/05/07/MySQL/45/"><meta property="og:site_name" content="三月三"><meta property="og:description" content="3.1 SQL 语言概述一、SQL 具有四个主要的功能SQL 有两种使用方法 :              交互式 SQL: 一种与用户交互的方式，适合非计算机专业人员。 宿主型 SQL: 一种作为子语言嵌入到其它程序设计语言中，适合于程序设计人员用高级语言编写应用程序并与数据库打交道 , 嵌入到主语言中使用。  主要功能:             数据定义（ DDL）:主要用于创建、修改、删除数"><meta property="og:image" content="http://cdn.panyucable.cn/zysheep/mysql_PNG32.png"><meta property="article:published_time" content="2018-05-07T02:30:45.000Z"><meta property="article:modified_time" content="2020-06-29T09:46:39.153Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="https://zysheep.cn/2018/05/07/MySQL/45/"><link rel="prev" title="Maven 简介" href="https://zysheep.cn/2018/05/08/SimpleApp/Maven/53/"><link rel="next" title="Intellij IDEA安装和使用" href="https://zysheep.cn/2018/05/07/SimpleApp/Intellij%20%20IDEA/46/"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5/js/md5.min.js"></script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7f671f0f6d996680d21d5c32a23a9313";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://zysheep.github.io/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: true,
  fancybox: false,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: true,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@master/Hexo/css/hideCategory.min.css"><meta name="generator" content="Hexo 4.2.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/zysheep/picgo-imgs/img41.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">205</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">46</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">68</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于三月三</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-bug" aria-hidden="true"></i><span> 编程路线</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/java/"><i class="fa-fw fa fa-coffee"></i><span> Java</span></a></li><li><a class="site-page" href="/python/"><i class="fa-fw fa fa-binoculars"></i><span> Python</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-folder-open" aria-hidden="true"></i><span> 面试宝典</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/interview/"><i class="fa-fw fa fa-file-text-o"></i><span> Java面试题</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 我的生活</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/gallery/"><i class="fa-fw fa fa-picture-o"></i><span> Gallery</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-SQL-语言概述"><span class="toc-number">1.</span> <span class="toc-text">3.1 SQL 语言概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#一、SQL-具有四个主要的功能"><span class="toc-number">1.1.</span> <span class="toc-text">一、SQL 具有四个主要的功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二、语言的特点"><span class="toc-number">1.2.</span> <span class="toc-text">二、语言的特点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-基本数据类型"><span class="toc-number">2.</span> <span class="toc-text">3.2 基本数据类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-数据定义语言-DDL"><span class="toc-number">3.</span> <span class="toc-text">3.3 数据定义语言(DDL)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#一、数据库"><span class="toc-number">3.0.1.</span> <span class="toc-text">一、数据库</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二、表"><span class="toc-number">3.1.</span> <span class="toc-text">二、表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三、索引"><span class="toc-number">3.2.</span> <span class="toc-text">三、索引</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#唯一索引"><span class="toc-number">3.2.1.</span> <span class="toc-text">唯一索引</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#四、视图"><span class="toc-number">3.3.</span> <span class="toc-text">四、视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#五、存储过程"><span class="toc-number">3.4.</span> <span class="toc-text">五、存储过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#六、触发器"><span class="toc-number">3.5.</span> <span class="toc-text">六、触发器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-数据操纵语言-DML"><span class="toc-number">4.</span> <span class="toc-text">3.4 数据操纵语言(DML)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-5-数据查询语言"><span class="toc-number">5.</span> <span class="toc-text">3.5 数据查询语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#一、查询语言格式"><span class="toc-number">5.1.</span> <span class="toc-text">一、查询语言格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二、简单查询"><span class="toc-number">5.2.</span> <span class="toc-text">二、简单查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三、复杂查询：-涉及多个表的查询"><span class="toc-number">5.3.</span> <span class="toc-text">三、复杂查询： 涉及多个表的查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#四、正则表达式查询"><span class="toc-number">5.4.</span> <span class="toc-text">四、正则表达式查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-6-数据控制语言-DCL"><span class="toc-number">6.</span> <span class="toc-text">3.6 数据控制语言(DCL)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#并发事务带来的问题"><span class="toc-number">6.0.1.</span> <span class="toc-text">并发事务带来的问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#不可重复度和幻读区别："><span class="toc-number">6.0.2.</span> <span class="toc-text">不可重复度和幻读区别：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#事务隔离级别"><span class="toc-number">6.0.3.</span> <span class="toc-text">事务隔离级别</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL-ALTER命令"><span class="toc-number">7.</span> <span class="toc-text">MySQL ALTER命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#删除，添加或修改表字段"><span class="toc-number">7.1.</span> <span class="toc-text">删除，添加或修改表字段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改字段类型及名称"><span class="toc-number">7.2.</span> <span class="toc-text">修改字段类型及名称</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ALTER-TABLE-对-Null-值和默认值的影响"><span class="toc-number">7.3.</span> <span class="toc-text">ALTER TABLE 对 Null 值和默认值的影响</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改字段默认值"><span class="toc-number">7.4.</span> <span class="toc-text">修改字段默认值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改表名"><span class="toc-number">7.5.</span> <span class="toc-text">修改表名</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL-临时表"><span class="toc-number">8.</span> <span class="toc-text">MySQL 临时表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL-复制表"><span class="toc-number">9.</span> <span class="toc-text">MySQL 复制表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL-元数据"><span class="toc-number">10.</span> <span class="toc-text">MySQL 元数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL-序列使用"><span class="toc-number">11.</span> <span class="toc-text">MySQL 序列使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#重置序列"><span class="toc-number">11.1.</span> <span class="toc-text">重置序列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设置序列的开始值"><span class="toc-number">11.2.</span> <span class="toc-text">设置序列的开始值</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(http://cdn.panyucable.cn/zysheep/mysql_PNG32.png)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">三月三</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于三月三</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-bug" aria-hidden="true"></i><span> 编程路线</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/java/"><i class="fa-fw fa fa-coffee"></i><span> Java</span></a></li><li><a class="site-page" href="/python/"><i class="fa-fw fa fa-binoculars"></i><span> Python</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-folder-open" aria-hidden="true"></i><span> 面试宝典</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/interview/"><i class="fa-fw fa fa-file-text-o"></i><span> Java面试题</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 我的生活</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/gallery/"><i class="fa-fw fa fa-picture-o"></i><span> Gallery</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">MySQL管理和语法</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2018-05-07 10:30:45"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2018-05-07</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-06-29 17:46:39"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-06-29</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/MySQL/">MySQL</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">9k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 30 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-comment-o" aria-hidden="true"></i><span>评论数:</span><a href="/2018/05/07/MySQL/45/#post-comment"><span class="gitalk-comment-count comment-count"></span></a></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="3-1-SQL-语言概述"><a href="#3-1-SQL-语言概述" class="headerlink" title="3.1 SQL 语言概述"></a>3.1 SQL 语言概述</h2><h3 id="一、SQL-具有四个主要的功能"><a href="#一、SQL-具有四个主要的功能" class="headerlink" title="一、SQL 具有四个主要的功能"></a>一、SQL 具有四个主要的功能</h3><p>SQL 有两种使用方法 :            </p>
<ul>
<li>交互式 SQL: 一种与用户交互的方式，适合非计算机专业人员。</li>
<li>宿主型 SQL: 一种作为子语言嵌入到其它程序设计语言中，适合于程序设计人员<br>用高级语言编写应用程序并与数据库打交道 , 嵌入到主语言中使用。</li>
</ul>
<p><strong>主要功能:</strong>           </p>
<ol>
<li>数据定义（ DDL）:主要用于创建、修改、删除数据库及其中的对象。如：表、视图、索引等；</li>
<li>数据操纵（ DML）:主要用于对关系中的数据进行增、删、改和更新等操作；</li>
<li>数据查询：主要用于对数据进行检索查询等；</li>
<li>数据控制（ DCL）:主要用于对数据库的访问权限的授予或撤消、完整性规则描述、事务控制等操作</li>
</ol>
<h3 id="二、语言的特点"><a href="#二、语言的特点" class="headerlink" title="二、语言的特点"></a>二、语言的特点</h3><ol>
<li>非过程化语言:一次处理一条记录 , 对数据提供自动导航。</li>
<li>统一的语言:对所有用户都适用。提供的命令有：查询数据；在表中插入、修改和删除记录；建立、 修改和删除数据对象；控制对数据和数据对象的存取；保证数据库一致性和完整性等。</li>
<li>是所有关系数据库的公共语言</li>
</ol>
<h2 id="3-2-基本数据类型"><a href="#3-2-基本数据类型" class="headerlink" title="3.2 基本数据类型"></a>3.2 基本数据类型</h2><p>主要数据类型:数值型、字符型、日期型、二进制型、位型和双字节型</p>
<p>1.数值数据类型:用于存储数值型数据</p>
<ul>
<li>整数型：包括 <code>Bitint</code> 、<code>Int</code> 、<code>Smallint</code> 、<code>Tinyint</code>, 一般使用 <code>Int</code> 型。</li>
</ul>
<table>
<thead>
<tr>
<th>对象</th>
<th>年龄区间</th>
<th>类型</th>
<th>字节</th>
<th>表示范围</th>
</tr>
</thead>
<tbody><tr>
<td>人</td>
<td>150 岁之内</td>
<td>tinyint unsigned</td>
<td>1</td>
<td>无符号值：0 到 255</td>
</tr>
<tr>
<td>龟</td>
<td>数百岁</td>
<td>smallint unsigned</td>
<td>2</td>
<td>无符号值：0 到 65535</td>
</tr>
<tr>
<td>恐龙化石</td>
<td>数千万年</td>
<td>int unsigned</td>
<td>4</td>
<td>无符号值：0 到约 42.9 亿</td>
</tr>
<tr>
<td>太阳</td>
<td>约 50 亿年</td>
<td>bigint unsigned</td>
<td>8</td>
<td>无符号值：0 到约 10 的 19 次方</td>
</tr>
</tbody></table>
<ul>
<li>精确数值：用于存储带小数位的数据，包括 <code>Decimal</code> 、<code>Numeric</code> ，一般使用后者。</li>
<li>浮点数值：（ <code>Float</code>,<code>Real</code>) 存储非常大带小数的数据。</li>
<li>货币型：带四位小数的浮点数。</li>
</ul>
<p>2.字符型：用于存储字符型数据</p>
<ul>
<li>Char 型：长度固定；</li>
<li>Varchar 型：长度不固定；</li>
<li>Text 型：存储字符型数据非常大， 长度超过 8000 个字符时使用， 最大可存储 2G 的数据。</li>
</ul>
<p>3.日期时间型：存储日期和时间的组合数据。</p>
<ul>
<li>Datetime: 1753 年 1 月 1 日 至 9999 年 12 月 31 日，占 8 个字符的存储空间。</li>
<li>Small Datetime: 1900 年 1 月 1 日 至 2079 年 6 月 6 日，占 4 个字符的存储空间。</li>
</ul>
<p>4.二进制:存储图形图像、 WORD文档等。</p>
<ul>
<li>包括:<code>Image</code> 、<code>Binary</code> 、<code>var binary</code> 。其中，<code>Image</code> 用于存储照片、音频和视频等文件。</li>
</ul>
<p>5.位型：<code>Bit</code> 逻辑数据，用于存储 <code>1</code>或 <code>0</code>，只有一位字节 </p>
<p>6.特殊数据类型： 用于存储特殊用途的数据</p>
<h2 id="3-3-数据定义语言-DDL"><a href="#3-3-数据定义语言-DDL" class="headerlink" title="3.3 数据定义语言(DDL)"></a>3.3 数据定义语言(DDL)</h2><h4 id="一、数据库"><a href="#一、数据库" class="headerlink" title="一、数据库"></a>一、数据库</h4><p>1.数据库的概念:对象的集合，主要包括<code>表</code>、<code>索引</code>、<code>视图</code>、<code>存储过程</code>等。数据库在磁盘上以文件形式存储，由数据文件和日志文件组成。先建立数据库，然后才能建立对象 ,<strong>如:</strong> 表、索引等。</p>
<p>2.数据库的定义： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE &lt;数据库名 &gt;</span><br></pre></td></tr></table></figure>
<p><strong>功能:</strong> 建立一个空数据库。该语句执行后，可以使用“ <code>USE &lt;数据库 &gt;</code>” 命令把已建<br>立的一个数据库置为当前数据库。此后所有操作,包括建立、修改、删除基本表等操作均对当前数据库进行操作。<br>例： <code>Create DATABASE</code> 教学管理库</p>
<p>3.删除数据库 : </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP DATABASE &lt;数据库名 &gt;</span><br></pre></td></tr></table></figure>
<p><strong>功能:</strong> 删除（撤消）数据库；同时将删除数据库中所有对象。<br>例： <code>DROP DATABASE 教学管理库</code></p>
<h3 id="二、表"><a href="#二、表" class="headerlink" title="二、表"></a>二、表</h3><p>1.表的概念:表是数据库的操作对象之一，是数据库最基本、最重要的对象。其他对象，如查询、窗体和报表都是在表的基础上建立和使用的。表由行（<code>记录</code>）和列（<code>字段</code>）组成。</p>
<table>
<thead>
<tr>
<th>学号</th>
<th>课程号</th>
<th>成绩</th>
</tr>
</thead>
<tbody><tr>
<td>001</td>
<td>K01</td>
<td>60</td>
</tr>
<tr>
<td>001</td>
<td>K02</td>
<td>70</td>
</tr>
<tr>
<td>002</td>
<td>K01</td>
<td>90</td>
</tr>
<tr>
<td>002</td>
<td>K02</td>
<td>80</td>
</tr>
</tbody></table>
<p>2.数据表具有的属性：  </p>
<ul>
<li>表名:表的唯一标识；   </li>
<li>记录:表中的每行为一条记录</li>
<li>字段:表的列为字段，每个字段需定义字段名称、字段类型、宽度等；</li>
<li>主关键字:能够唯一地标识表的每条记录的字段或字段组合。<ul>
<li>如:学生表的主关键字为“<code>学号</code>”，选课表的“<code>学号</code>”和“<code>课程号</code>”的组合为关键字。</li>
</ul>
</li>
<li>域:每个字段的取值范围。</li>
</ul>
<p>3.创建表结构                </p>
<ul>
<li>命令格式:<code>CREATE TABLE &lt;基本表名&gt; （&lt;列名 1&gt; &lt;列的类型&gt; &lt;列的完整性&gt; ，
&lt;列名 2&gt; &lt;列的类型&gt;&lt;列的完整性&gt;, …）</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">如: 创建学生信息表</span><br><span class="line">create table student (</span><br><span class="line">    sno int primary key auto_increment not null,</span><br><span class="line">    sname varchar(10),</span><br><span class="line">    sage int </span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
<li>功能：在当前或给定的数据库中定义一个表结构（关系模式）</li>
<li>列定义包括：属性名，数据类型，完整性约束。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE IF NOT EXISTS &#96;book&#96;(</span><br><span class="line">   &#96;book_id&#96; INT UNSIGNED AUTO_INCREMENT,</span><br><span class="line">   &#96;book_title&#96; VARCHAR(100) NOT NULL,</span><br><span class="line">   &#96;book_author&#96; VARCHAR(40) NOT NULL,</span><br><span class="line">   &#96;submission_date&#96; DATE,</span><br><span class="line">   PRIMARY KEY ( &#96;runoob_id&#96; )</span><br><span class="line">)ENGINE&#x3D;InnoDB DEFAULT CHARSET&#x3D;utf8;</span><br></pre></td></tr></table></figure>
实例解析：</li>
<li>如果你不想字段为 NULL 可以设置字段的属性为 NOT NULL， 在操作数据库时如果输入该字段的数据为NULL ，就会报错。</li>
<li>AUTO_INCREMENT定义列为自增的属性，一般用于主键，数值会自动加1。</li>
<li>PRIMARY KEY关键字用于定义列为主键。 您可以使用多列来定义主键，列间以逗号分隔。</li>
<li>ENGINE 设置存储引擎，CHARSET 设置编码。</li>
</ul>
<p>常用的表中数据类型有以下几种：</p>
<ul>
<li><code>char(n)</code>: 定长度字符型，如：姓名 char(10) ；</li>
<li><code>varchar</code> ：变长度字符型；</li>
<li><code>Int</code> ：整型，占 4 个字节；</li>
<li><code>Float</code> ：浮点数（实数）占 4 或 8 个字节；</li>
<li><code>Date</code> ：日期型 <code>yyyy-mm-dd,(yyyy/mm/dd)</code> 占 4 个或 8 个字节</li>
</ul>
<p>列级完整性约束 : 有六种</p>
<ul>
<li><code>DEFAULT&lt; 常量表达式 &gt;</code> ：默认值约束。</li>
<li><code>NULL/NOT NULL 空值 / 非空值</code>：对于非主属性，若不注明此约束，则隐含为允许空值<br>约束。</li>
<li><code>PRIMARY KEY</code>：主码约束。</li>
<li><code>UNIQUE</code>：单值约束，惟一值约束。</li>
<li><code>REFERNCES&lt; 父表名 &gt; (&lt; 主码 &gt;)</code>: 外码约束。</li>
<li><code>CHECK(&lt; 逻辑表达式 &gt;)</code>: 检查约束，取值限制</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">举例：创建学生基本表</span><br><span class="line">CREATE TABLE 学生 ( </span><br><span class="line">学生号 char(7) primary key ，</span><br><span class="line">姓名 char(6) ，</span><br><span class="line">性别 char(2) ，</span><br><span class="line">出生年月 datetime, </span><br><span class="line">专业 char(10), </span><br><span class="line">年级 int );</span><br></pre></td></tr></table></figure>

<p>表级完整性约束 : 有四种</p>
<ul>
<li>PRIMARY KEY（&lt; 列名 &gt;, … ）主码约束 : 注明一个或多个列为主码。</li>
<li>UNIQUE（&lt; 列名 &gt; , … ）单值约束：注明一个或同时若干个列为单值。</li>
<li>FOREING KEY &lt; 列名 &gt;, … REFRENCES&lt; 父表名 &gt;(&lt; 主码列名 &gt;) 外码约束：注明一<br>个或同时若干个列为外码。</li>
<li>CHECK(&lt; 逻辑表达式 &gt;) 检查约束：注明每行中一个或若干个列的取值限制</li>
</ul>
<p><strong>除默认值约束、空值 / 非空值约束外，对于其它约束，若只涉及到一个列时，则可以作列级完整性约束，又可以作表级完整性约束。若涉及到多个列时,则只能作为表级完整性约束</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">举例：创建选课基本表</span><br><span class="line">CREATE TABLE 选课 ( </span><br><span class="line">学生号 char(7) ，</span><br><span class="line">课程号 char(4), </span><br><span class="line">成绩 int check( 成绩 &gt;&#x3D;0 and 成绩 &lt;&#x3D;100), </span><br><span class="line"> primary key ( 学生号 , 课程号 ), </span><br><span class="line"> Foreign key ( 学生号 ) refrences 学生 ( 学生号），</span><br><span class="line"> Foreign key ( 课程号 ) refrences 课程 ( 课程号）</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>4．表的删除</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE &lt;表名&gt;</span><br></pre></td></tr></table></figure>

<h3 id="三、索引"><a href="#三、索引" class="headerlink" title="三、索引"></a>三、索引</h3><p>1.索引的概念:索引提供一种快速访问数据的途径 ,当数据库很大时，在表中建立若干个索引，会加快查询。索引有以下特点：          </p>
<ul>
<li>索引是在表中的某列上建立的数据库对象，它和表分开存储，它的建立或撤消对<br>数据的内容没有影响。</li>
<li>索引一经创建，就完全由系统自动选择和维护。</li>
<li>表中的记录数量越多，越有必要建立索引。</li>
<li>索引是为加快查询速度，但其影响表中数据的插入、删除和修改</li>
</ul>
<ol start="2">
<li>创建原则</li>
</ol>
<ul>
<li>表中的记录数量越多，越有必要建立索引。</li>
<li>索引是为加快查询速度，但其影响表中数据的插入、删除和修改。</li>
<li>索引是建立在基本表列上的对象,通常需要在经常出现在 <code>WHERE</code>、<code>ORDER BY</code>、<code>GROUP 
BY</code>子句中的列建立索引。</li>
</ul>
<ol start="3">
<li>不易创建索引的情况               </li>
</ol>
<ul>
<li>包含太多重复值的列</li>
<li>查询中很少被引用的列</li>
<li>值特别长的列</li>
<li>具有很多 NULL 值的列</li>
<li>需要经常更新的列</li>
<li>记录较少的表等。</li>
</ul>
<ol start="4">
<li>索引的类型</li>
</ol>
<ul>
<li>单列索引 : 对基本表的某一单独列进行索引，通常是对主关键字建立。</li>
<li>唯一索引 : 建立唯一索引后，则不允许在该列上插入相同的值。</li>
<li>复合索引 : 对表的两个或多个列上建立索引。</li>
<li>聚集索引 : 改变表中记录的物理存储顺序，即表中记录的物理排列顺序不再按插入的顺序排列。</li>
<li>非聚集索引 : 不改变表中记录的物理存储顺序，即表中记录的物理顺序和索引顺序不同</li>
</ul>
<ol start="5">
<li>聚集索引和非聚集索引对比 : </li>
</ol>
<ul>
<li>存取速度 : 聚集索引查询速度快 , 但降低更新速度。</li>
<li>索引的数据 : 一个表只能建立一个聚集索引, 但可以建立多个非聚集索引。</li>
<li>所用空间 : 非聚集索引需要较多的空间。</li>
</ul>
<p>6.创建索引 : <code>CREATE [UNIQUE] [CLUSTERED] INDEX &lt;索引名 &gt; ON &lt; 表名 &gt; (&lt; 列名 1&gt; &lt; 次 序&gt; …。</code></p>
<ul>
<li>UNIQUE：创建唯一索引；</li>
<li>CLUSTERED：创建聚集索引；</li>
<li>次序：表示排列次序， ASC 表示升序； DESC 表示降序。<br><strong>如：</strong> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE INDEX indexName ON mytable(username(length));</span><br></pre></td></tr></table></figure>
如果是CHAR，VARCHAR类型，length可以小于字段实际长度；如果是BLOB和TEXT类型，必须指定 length。</li>
</ul>
<ol start="7">
<li>修改表结构(添加索引)<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER table tableName ADD INDEX indexName(columnName)</span><br></pre></td></tr></table></figure></li>
<li>删除索引： <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP INDEX [indexName] ON mytable; ，… 一次可以删除一个或多个索引</span><br></pre></td></tr></table></figure>
<h4 id="唯一索引"><a href="#唯一索引" class="headerlink" title="唯一索引"></a>唯一索引</h4>它与前面的普通索引类似，不同的就是：索引列的值必须唯一，但允许有空值。如果是组合索引，则列值的组合必须唯一。它有以下几种创建方式</li>
</ol>
<p><strong>创建索引</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE UNIQUE INDEX indexName ON mytable(username(length))</span><br></pre></td></tr></table></figure>
<p><strong>修改表结构</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER table mytable ADD UNIQUE [indexName] (username(length))</span><br></pre></td></tr></table></figure>




<h3 id="四、视图"><a href="#四、视图" class="headerlink" title="四、视图"></a>四、视图</h3><ul>
<li><p>视图是建立在基本表上的一个虚表，它的结构和内容都来自基本表，它依据基本表存在而存在。视图的列可以来自一个基本表或多个基本表。</p>
</li>
<li><p>视图的建立和删除只影响视图本身，不影响对应的基本表，而对视图的更新（插入、删除和修改）直接影响基本表。对视图做的最多的是查询操作。 当删除表时同时删除在表建立的视图</p>
</li>
<li><p>视图能够增强安全性，使数据库中一些保密的数据对无关人员成为不可见的，从而不能随意查询。</p>
</li>
</ul>
<p>创建视图：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE VIEW &lt;视图名 &gt;（&lt;列名 &gt;，… ) AS &lt;SELECT 子句 &gt;；</span><br></pre></td></tr></table></figure>
<p>为当前数据库根据 SELECT 子句查询结果建立视图。</p>
<p>举例： 把计算机系学生的学号和姓名创建为视图：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE VIEW CSStudent AS </span><br><span class="line"> SELECT StudentNo, StudentName </span><br><span class="line"> FROM Student </span><br><span class="line"> WHERE Dept&#x3D;‘计算机系&#39; ；</span><br></pre></td></tr></table></figure>
<p>可把 <code>CSStudent</code> 看作是一个虚拟的表</p>
<p>删除（撤消）视图：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP VIEW &lt;视图名 &gt;；</span><br></pre></td></tr></table></figure>


<h3 id="五、存储过程"><a href="#五、存储过程" class="headerlink" title="五、存储过程"></a>五、存储过程</h3><p>1.存储过程 : 存储过程是一组预先编译好的 <code>Transact SQL</code> 代码，是一种可执行的永久存储在数据的<code>SQL</code> 代码中。可以作为一个独立的数据库对象被用户使用。      </p>
<p>2.存储过程的作用 : 它可以接收参数 , 并以输出参数的形式返回多个参数给调用它<br>的过程或批处理，使用存储过程优点：</p>
<ul>
<li>执行速度快 : 存储过程在创建时就经过了语法检查和性能优化，因此在执行时不<br>必再重复这些步骤。 存储过程在经过第一次调用后， 就驻留在内存中， 不必再经过编译和优<br>化，所以执行速度快。</li>
<li>模块化的程序设计 : 可以被多次调用， 用户可以独立于应用程序而对存储过程进<br>行修改，增加了数据库应用程序的易修改特征。</li>
<li>减少网络流量 : 存储过程可以包含大量的 <code>Transact SQL</code> 语句 , 但在进行调用时 ,<br>客户端只需要使用一个语句就可以实现了 , 大大减少了网络上数据的传输量。</li>
<li>保证系统的安全性 : 存储过程存放在数据库服务器端 , 对于某些关键数据 , 可以<br>设置成只通过存储过程来访问 , 不允许用户直接使用 <code>Transact SQL</code> 语句或企业管理器对<br>数据进行访问</li>
</ul>
<p>3.创建存储过程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROC 存储过程名 AS SQL 语句</span><br></pre></td></tr></table></figure>
<p><code>SQL</code>语句是利用 <code>Transact SQL</code> 编写的程序</p>
<p>4.执行存储过程 : 如果对存储过程的调用是批处理的第一条语句， 则可直接使用存储<br>过程的名字调用。如果不是第一条语句，调用的语法： <code>EXEC</code> 存储过程名。</p>
<p>举例 : <strong>创建 USER_PROC1 存储过程</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROC USER_PROC1 </span><br><span class="line">AS </span><br><span class="line">SELECT * FROM 学生表</span><br><span class="line">GO</span><br></pre></td></tr></table></figure>

<h3 id="六、触发器"><a href="#六、触发器" class="headerlink" title="六、触发器"></a>六、触发器</h3><p>触发器是一个特殊的存储过程 , 它基于一个表的创建 , 但可以针对多个表进行操作 , 主要用来保证数据的完整性。一张表可以创建多年触发器 , 用户可以针对 <code>UPDATE</code>、<br><code>DELETE</code>、<code>INSERT</code> 语句分别设置触发器，当用户进行 <code>UPDATE</code>、 <code>DELETE</code>、<code>INSERT</code>等操作后，<br>这些事先定义好的触发器对象就会被触发，并按事先定义好的规则自动执行。</p>
<p>创建触发器： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE TRIGGER 触发器名 ON 表名 &#x2F; 视图名 OF [DELETE，INSERT，</span><br><span class="line">UPDATE] AS SQL 语句</span><br></pre></td></tr></table></figure>
<p>主要参数： <code>DELETE</code>、<code>INSERT</code>、<code>UPDATE</code> 指定在表或视图上执行哪些数据修改语句时将激<br>活触发器的关键字。必须至少指定一个选项。</p>
<p>举例： <strong>当对学生表执行 DELETE 语句时 , 同时删除成绩表中学号相同的记录。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TRIGGER 删除学号 ON 学生表</span><br><span class="line"> OF DELETE </span><br><span class="line"> AS </span><br><span class="line"> DECLARE @Myno char(4) </span><br><span class="line"> Select @Myno&#x3D; 学号 FROM DELETED </span><br><span class="line"> DELETE FROM 成绩表 WHERE 学号 &#x3D;@Myno </span><br><span class="line"> RETURN</span><br></pre></td></tr></table></figure>

<h2 id="3-4-数据操纵语言-DML"><a href="#3-4-数据操纵语言-DML" class="headerlink" title="3.4 数据操纵语言(DML)"></a>3.4 数据操纵语言(DML)</h2><p>1.插入记录命令格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT [INTO] &lt; 基本表名 &gt;（&lt;列名 &gt;, … ) VALUES ( 列值 , … )</span><br></pre></td></tr></table></figure>
<p>向表中插入完整的记录时 , 可省略列名列表。例如：学生关系（学生号，姓名，性别，专业）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT into 学生（学生号，姓名，性别，专业） VALUES（&#39;001&#39;，&#39;李宏&#39; ，&#39;女&#39; ，&#39;计算机&#39;）</span><br></pre></td></tr></table></figure>
<p>与下面语句功能相同</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT into 学生 VALUES（&#39;001&#39;，&#39;李宏&#39; ，&#39;女&#39; ，&#39;计算机&#39;）</span><br></pre></td></tr></table></figure>

<p>2.修改记录命令格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE &lt;表名 &gt; SET &lt; 列名 &gt;&#x3D; &lt; 表达式 &gt;, … WHERE &lt; 逻辑表达式 &gt; ；</span><br></pre></td></tr></table></figure>
<p>功能：按条件修改表中的一些列值。 <code>SET</code>：要修改的列值；<code>WHERE</code>：修改记录条件，省略参数将修改表中所有记录。</p>
<p><strong>例:</strong> 将所有计算机系学生的年龄增加 1 岁，并且把系名改为”计算机科学系”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE Student SET Age&#x3D;Age+1, Dept&#x3D;&#39;计算机科学系&#39; WHERE Dept&#x3D; &#39;计算机科学系&#39;;</span><br></pre></td></tr></table></figure>

<p>3.删除记录命令格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM &lt;表名 &gt; WHERE &lt;逻辑表达式 &gt;;</span><br></pre></td></tr></table></figure>
<p>例: 删除学号为 9900203 的学生记录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM Student WHERE 学生号 &#x3D;&#39;9900203&#39;;</span><br></pre></td></tr></table></figure>

<h2 id="3-5-数据查询语言"><a href="#3-5-数据查询语言" class="headerlink" title="3.5 数据查询语言"></a>3.5 数据查询语言</h2><p><code>SQL</code>中最简单的查询就是从某个关系中查找满足某种条件的<code>元组</code>，类似于关系代数中的选择运算</p>
<h3 id="一、查询语言格式"><a href="#一、查询语言格式" class="headerlink" title="一、查询语言格式"></a>一、查询语言格式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Select 字段列表 [Into]&lt; 基本表 &gt;] </span><br><span class="line"> From &lt; 源表名 &gt; </span><br><span class="line"> [Where &lt; 查询条件 &gt; ] </span><br><span class="line"> [GROP by &lt; 分组列名 1&gt; [Having &lt; 查询条件 &gt;] </span><br><span class="line"> [Order by &lt; 排序表达式 &gt; [ASC] [DESC]</span><br></pre></td></tr></table></figure>

<h3 id="二、简单查询"><a href="#二、简单查询" class="headerlink" title="二、简单查询"></a>二、简单查询</h3><p>假设教学数据库包括： 学生、课程和成绩三个基本表。</p>
<p>1.查询指定的字段：用“，”隔开需要查询的字段<br><strong>例:</strong> 查询学生表所有学生的学号和姓名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Select 学号 , 姓名 FROM 学生</span><br></pre></td></tr></table></figure>
<p>2.通配符“ <em>”查询所有字段<br>*</em>例:** 查询学生表所有学生的所有字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Select * FROM 学生</span><br></pre></td></tr></table></figure>
<p>3.基于字段的表达式 : 使用字段构成需要查询的表达式，如：</p>
<p><strong>例:</strong> 查询所有学生的学号和出生年月。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Select 学号 ,STR(YEAR(出生日期 ),4)+ ‘年’ + STR(MONTH( 出生日期 ),2)+ ‘月’ AS 出生年月 FROM 学生</span><br></pre></td></tr></table></figure>
<p><code>AS</code>选项定义表达式的列名，若省略 <code>AS</code> 选项，则字段名作为列名使用。</p>
<p>4.<code>ALL/DISTINCT</code> : 默认值为 <code>ALL</code>, 表示允许查询结果中出现内容重复的行；若选择<br><code>DISTINCT</code> 则表示不允许出现内容重复的行。<br><strong>例:</strong> 查询学生表中专业数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Select DISTINCT 专业  FROM 学生</span><br></pre></td></tr></table></figure>

<p>5.<code>WHERE</code>选项 : 定义基本表之间的连接条件和对记录的筛选条件。连接条件通常为等值连<br>接, 筛选条件是从源表中选择出满足条件的行,筛选条件可以是一般比较式,也可以是通过逻辑运算符连接的逻辑表达式</p>
<p>1)使用 <code>BETWEEN</code> 短语查询。短语格式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BETWEEN&lt; 开始值 &gt; AND &lt; 结束值 &gt;</span><br></pre></td></tr></table></figure>
<p><strong>例：</strong> 查询年龄在 19 岁-21 岁的学生。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from 学生 where 年龄 19 and 21;</span><br></pre></td></tr></table></figure>

<p>2)使用 NULL 查询：<br><strong>例：</strong> 查询成绩不为空值的所有记录。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from 成绩 where NOT （成绩 IS NULL）</span><br></pre></td></tr></table></figure>

<p>3)使用日期进行查询：<br><strong>例：</strong> 查询 1985 年 1 月 1 日 后出生的学生。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from 学生 出生日期 &gt;&#39;1985-01-01&#39;;</span><br></pre></td></tr></table></figure>

<p>4)使用 IN 查询： IN( 常量表 )<br><strong>例：</strong> 查询年龄为 19 岁或 21 岁的记录。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from 学生 where 年龄 IN(19,21);</span><br></pre></td></tr></table></figure>

<p>5)使用 LIKE 查询：列名 LIKE 表达式 ( 用%(所有)、_(一个占位符)构成表达式）<br><strong>例：</strong> 查询姓“王” 的所有学生。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from 学生 where 姓名 LIKE ‘王 %&#39;;</span><br></pre></td></tr></table></figure>

<p>6.<code>ORDER BY &lt; 排序列名 1&gt; ， &lt; 排序列名 2&gt;</code>：将查询结果按排序列进行排序，查询结果首<br>先按排序列名 1 的值排序， 若该列的值相同， 再按排序列名 2 的值排序。 排序方式有两种，<br>关键字 <code>DESC</code> 表示降序， <code>ASC</code> 表示升序，若省略表示升序。<br><strong>例:</strong> 从教学库中查询出所有学生的学号和姓名，查询结果按学生号升序排列。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 学生号 , 姓名 from 学生 order by 学生号 ASC;</span><br></pre></td></tr></table></figure>

<p>7.统计函数的使用：</p>
<ul>
<li><code>COUNT（[ALL/DISTINCT]&lt; 列名 &gt;|* ）</code>：统计指定列的值个数；</li>
<li><code>MAX（&lt; 列名 &gt; ）</code>求出对应的数值、字符或日期列的最大值；</li>
<li><code>MIN（&lt; 列名 &gt; ）</code>求出对应的数值、字符或日期列的最小值；</li>
<li><code>AVG（&lt; 列名 &gt; ）</code>求出对应的数值列的平均值；</li>
<li><code>SUM（&lt; 列名 &gt; ）</code>求出对应的数值列的总和。</li>
</ul>
<p><strong>例:</strong> 统计学生人数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Select COUNT (*) AS 学生人数  FROM 学生;</span><br></pre></td></tr></table></figure>
<p><strong>例:</strong> 统计每个专业的学生人数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Select COUNT (DISTINCT 专业 ) AS 专业数 FROM 学生;</span><br></pre></td></tr></table></figure>

<p>8.<code>GROUP BY &lt;分组列名 &gt;</code> ：按分组列名对查询结果中的所有元组进行分组，使得分组列值<br>相同的为一组，形成结果表中的一个元组。 <code>select</code>选项中只能包括分组列名和统计函数。 </p>
<p><strong>例:</strong> 查询每个专业的学生数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT name, COUNT(*) FROM   employee_tbl GROUP BY name;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+--------+----------+</span><br><span class="line">| name   | COUNT(*) |</span><br><span class="line">+--------+----------+</span><br><span class="line">| 小丽 |        1 |</span><br><span class="line">| 小明 |        3 |</span><br><span class="line">| 小王 |        2 |</span><br><span class="line">+--------+----------+</span><br></pre></td></tr></table></figure>
<p>9.<code>WITH ROLLUP</code>:实现在分组统计数据基础上再进行相同的统计（SUM,AVG,COUNT…）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT name, SUM(singin) as singin_count FROM  employee_tbl GROUP BY name WITH ROLLUP;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+--------+--------------+</span><br><span class="line">| name   | singin_count |</span><br><span class="line">+--------+--------------+</span><br><span class="line">| 小丽 |            2 |</span><br><span class="line">| 小明 |            7 |</span><br><span class="line">| 小王 |            7 |</span><br><span class="line">| NULL   |           16 |</span><br><span class="line">+--------+--------------+</span><br></pre></td></tr></table></figure>
<p>可以使用<code>coalesce</code> 来设置一个可以取代 NUll 的名称，coalesce 语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select coalesce(a,b,c);</span><br></pre></td></tr></table></figure>
<p>参数说明：如果a==null,则选择b；如果b==null,则选择c；如果a!=null,则选择a；如果a b c 都为null ，则返回为null（没意义）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT coalesce(name, &#39;总数&#39;), SUM(singin) as singin_count FROM  employee_tbl GROUP BY name WITH ROLLUP;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+--------------------------+--------------+</span><br><span class="line">| coalesce(name, &#39;总数&#39;) | singin_count |</span><br><span class="line">+--------------------------+--------------+</span><br><span class="line">| 小丽                   |            2 |</span><br><span class="line">| 小明                   |            7 |</span><br><span class="line">| 小王                   |            7 |</span><br><span class="line">| 总数                   |           16 |</span><br><span class="line">+--------------------------+--------------+</span><br></pre></td></tr></table></figure>
<h3 id="三、复杂查询：-涉及多个表的查询"><a href="#三、复杂查询：-涉及多个表的查询" class="headerlink" title="三、复杂查询： 涉及多个表的查询"></a>三、复杂查询： 涉及多个表的查询</h3><p>1.连接查询 : 两表按公共字段等值连接查询<br><strong>例 :</strong> 查询学生的学号、姓名、课程号和成绩。查询需要用到两张表（学生，成绩）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT 学号、姓名、课程号，成绩</span><br><span class="line">FROM 学生表，成绩表</span><br><span class="line">WHERE 学生表.学号 &#x3D;成绩表.学号;</span><br></pre></td></tr></table></figure>

<p><strong>例:</strong> 查询出所有计算机专业学生的学号 , 姓名 , 课程号 , 课程名和成绩。 查询条件包括连接条件和选择条件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT 学号、姓名、课程号，成绩</span><br><span class="line">FROM 学生表，成绩表</span><br><span class="line">WHERE 学生表.学号 &#x3D;成绩表.学号 AND 专业 &#x3D;&#39;计算机&#39;;</span><br></pre></td></tr></table></figure>
<p>2.JOIN 来联合多表查询。</p>
<ul>
<li>INNER JOIN（内连接,或等值连接）：获取两个表中字段匹配关系的记录。</li>
<li>LEFT JOIN（左连接）：获取左表所有记录，即使右表没有对应匹配的记录。</li>
<li>RIGHT JOIN（右连接）： 与 LEFT JOIN 相反，用于获取右表所有记录，即使左表没有对应匹配的记录。</li>
</ul>
<p>INNER JOIN</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT a.runoob_id, a.runoob_author, b.runoob_count FROM runoob_tbl a INNER JOIN tcount_tbl b ON a.runoob_author &#x3D; b.runoob_author;</span><br></pre></td></tr></table></figure>
<p>MySQL的INNER JOIN(也可以省略 INNER 使用 JOIN，效果一样)来连接以上两张表来读取runoob_tbl表中所有runoob_author字段在tcount_tbl表对应的runoob_count字段值：</p>
<p>LEFT JOIN</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT a.runoob_id, a.runoob_author, b.runoob_count FROM runoob_tbl a LEFT JOIN tcount_tbl b ON a.runoob_author &#x3D; b.runoob_author;</span><br></pre></td></tr></table></figure>
<p>该语句会读取左边的数据表 runoob_tbl 的所有选取的字段数据，即便在右侧表 tcount_tbl中 没有对应的 runoob_author 字段值。</p>
<p>RIGHT JOIN</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT a.runoob_id, a.runoob_author, b.runoob_count FROM runoob_tbl a RIGHT JOIN tcount_tbl b ON a.runoob_author &#x3D; b.runoob_author;</span><br></pre></td></tr></table></figure>
<p>该语句会读取右边的数据表 tcount_tbl 的所有选取的字段数据，即便在左侧表 runoob_tbl 中没有对应的runoob_author 字段值。</p>
<p>3.嵌套查询 : 一个 <code>SELECT</code> 查询嵌套在另一个查询语句中。             </p>
<p><strong>例 1:</strong> 查询所有被女生选出的课程号和课程名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT 课程号 , 课程名 FROM 课程表</span><br><span class="line">WHERE 课程号 IN (SELECT 课程号 FROM 成绩单 WHERE 学号 IN (SELECT 学号 FROM 学生表 WHERE 性别 &#x3D;&#39;女 &#39;））;</span><br></pre></td></tr></table></figure>
<p>第一步：最内层的查询功能查询出所有女生的学号<br>第二步：第二层查询功能是从成绩单表中查询出女生选修课程的课程号；<br>第三步：最外层查询功能是从课程表中查询出被女生选修的所有课程的课程名和课程号。</p>
<p><strong>例 2:</strong> 求成绩小于总平均成绩的学生学号、姓名、专业。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT 学号 , 姓名，专业 FROM 学生表</span><br><span class="line">WHERE 学号 IN (SELECT DISTINCT 学号 FROM 成绩单 WHERE 成绩 &lt; (SELECT AVG （成绩） FROM 成绩表 ));</span><br></pre></td></tr></table></figure>
<p>第一步 : 计算全体学生的总平均成绩；<br>第二步 : 在成绩单中求出所有成绩小于总平成绩的学号；<br>第三步 : 用 <code>IN</code> 求出所有学号在第二步查出学号集合中的学生学号、姓名和专业。</p>
<h3 id="四、正则表达式查询"><a href="#四、正则表达式查询" class="headerlink" title="四、正则表达式查询"></a>四、正则表达式查询</h3><table>
<thead>
<tr>
<th>模式</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>^</td>
<td>匹配输入字符串的开始位置。如果设置了 RegExp 对象的 Multiline 属性，^ 也匹配 ‘\n’ 或 ‘\r’ 之后的位置。</td>
</tr>
<tr>
<td>$</td>
<td>匹配输入字符串的结束位置。如果设置了RegExp 对象的 Multiline 属性，$ 也匹配 ‘\n’ 或 ‘\r’ 之前的位置。</td>
</tr>
<tr>
<td>.</td>
<td>匹配除 “\n” 之外的任何单个字符。要匹配包括 ‘\n’ 在内的任何字符，请使用象 ‘[.\n]’ 的模式。</td>
</tr>
<tr>
<td>[…]</td>
<td>字符集合。匹配所包含的任意一个字符。例如， ‘[abc]’ 可以匹配 “plain” 中的 ‘a’。</td>
</tr>
<tr>
<td>[^…]</td>
<td>负值字符集合。匹配未包含的任意字符。例如， ‘[^abc]’ 可以匹配 “plain” 中的’p’。</td>
</tr>
<tr>
<td>p1</td>
<td>p2</td>
</tr>
<tr>
<td>*</td>
<td>匹配前面的子表达式零次或多次。例如，zo* 能匹配 “z” 以及 “zoo”。* 等价于{0,}。</td>
</tr>
<tr>
<td>+</td>
<td>匹配前面的子表达式一次或多次。例如，’zo+’ 能匹配 “zo” 以及 “zoo”，但不能匹配 “z”。+ 等价于 {1,}。</td>
</tr>
<tr>
<td>{n}</td>
<td>n 是一个非负整数。匹配确定的 n 次。例如，’o{2}’ 不能匹配 “Bob” 中的 ‘o’，但是能匹配 “food” 中的两个 o。</td>
</tr>
<tr>
<td>{n,m}</td>
<td>m 和 n 均为非负整数，其中n &lt;= m。最少匹配 n 次且最多匹配 m 次。</td>
</tr>
</tbody></table>
<p><strong>实例:</strong><br>查找name字段中以’st’为开头的所有数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT name FROM person_tbl WHERE name REGEXP &#39;^st&#39;;</span><br></pre></td></tr></table></figure>
<p>查找name字段中以’ok’为结尾的所有数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT name FROM person_tbl WHERE name REGEXP &#39;ok$&#39;;</span><br></pre></td></tr></table></figure>
<p>查找name字段中包含’mar’字符串的所有数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT name FROM person_tbl WHERE name REGEXP &#39;mar&#39;;</span><br></pre></td></tr></table></figure>
<p>查找name字段中以元音字符开头或以’ok’字符串结尾的所有数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT name FROM person_tbl WHERE name REGEXP &#39;^[aeiou]|ok$&#39;;</span><br></pre></td></tr></table></figure>




<h2 id="3-6-数据控制语言-DCL"><a href="#3-6-数据控制语言-DCL" class="headerlink" title="3.6 数据控制语言(DCL)"></a>3.6 数据控制语言(DCL)</h2><p>1.事务 : 事务是并发控制的基本单位，它反映了现实世界中需要以一个完整的单位提交的<br>一项工作。 <code>SQL Server</code> 通过事务机制，将逻辑相关的一组操作捆绑在一起，以便服务器保<br>持数据的完整性</p>
<p>一般来说，事务是必须满足4个条件（ACID:原子性（Atomicity，或称不可分割性）、一致性（Consistency）、隔离性（Isolation，又称独立性）、持久性（Durability）。</p>
<ul>
<li><strong>原子性:</strong>一个事务（transaction）中的所有操作，要么全部完成，要么全部不完成，不会结束在中间某个环节。事务在执行过程中发生错误，会被回滚（Rollback）到事务开始前的状态，就像这个事务从来没有执行过一样。</li>
<li><strong>一致性:</strong>在事务开始之前和事务结束以后，数据库的完整性没有被破坏。这表示写入的资料必须完全符合所有的预设规则，这包含资料的精确度、串联性以及后续数据库可以自发性地完成预定的工作。</li>
<li><strong>隔离性:</strong>数据库允许多个并发事务同时对其数据进行读写和修改的能力，隔离性可以防止多个事务并发执行时由于交叉执行而导致数据的不一致。事务隔离分为不同级别，包括读未提交（Read uncommitted）、读提交（read committed）、可重复读（repeatable read）和串行化（Serializable）。</li>
<li><strong>持久性:</strong>事务处理结束后，对数据的修改就是永久的，即便系统故障也不会丢失。</li>
</ul>
<h4 id="并发事务带来的问题"><a href="#并发事务带来的问题" class="headerlink" title="并发事务带来的问题"></a>并发事务带来的问题</h4><p>在典型的应用程序中，多个事务并发运行，经常会操作相同的数据来完成各自的任务（多个用户对统一数据进行操作）。并发虽然是必须的，但可能会导致以下的问题。</p>
<ul>
<li>脏读（Dirty read）: 当一个事务正在访问数据并且对数据进行了修改，而这种修改还没有提交到数据库中，这时另外一个事务也访问了这个数据，然后使用了这个数据。因为这个数据是还没有提交的数据，那么另外一个事务读到的这个数据是“脏数据”，依据“脏数据”所做的操作可能是不正确的。</li>
<li>丢失修改（Lost to modify）: 指在一个事务读取一个数据时，另外一个事务也访问了该数据，那么在第一个事务中修改了这个数据后，第二个事务也修改了这个数据。这样第一个事务内的修改结果就被丢失，因此称为丢失修改。 例如：事务1读取某表中的数据A=20，事务2也读取A=20，事务1修改A=A-1，事务2也修改A=A-1，最终结果A=19，事务1的修改被丢失。</li>
<li>不可重复读（Unrepeatableread）: 指在一个事务内多次读同一数据。在这个事务还没有结束时，另一个事务也访问该数据。那么，在第一个事务中的两次读数据之间，由于第二个事务的修改导致第一个事务两次读取的数据可能不太一样。这就发生了在一个事务内两次读到的数据是不一样的情况，因此称为不可重复读。</li>
<li>幻读（Phantom read）: 幻读与不可重复读类似。它发生在一个事务（T1）读取了几行数据，接着另一个并发事务（T2）插入了一些数据时。在随后的查询中，第一个事务（T1）就会发现多了一些原本不存在的记录，就好像发生了幻觉一样，所以称为幻读。</li>
</ul>
<h4 id="不可重复度和幻读区别："><a href="#不可重复度和幻读区别：" class="headerlink" title="不可重复度和幻读区别："></a>不可重复度和幻读区别：</h4><p>不可重复读的重点是修改，幻读的重点在于新增或者删除。</p>
<p><strong>例1</strong>（同样的条件, 你读取过的数据, 再次读取出来发现值不一样了 ）：事务1中的A先生读取自己的工资为 1000的操作还没完成，事务2中的B先生就修改了A的工资为2000，导 致A再读自己的工资时工资变为 2000；这就是不可重复读。</p>
<p><strong>例2</strong>（同样的条件, 第1次和第2次读出来的记录数不一样 ）：假如某工资单表中工资大于3000的有4人，事务1读取了所有工资大于3000的人，共查到4条记录，这时事务2 又插入了一条工资大于3000的记录，事务1再次读取时查到的记录就变为了5条，这样就导致了幻读。</p>
<h4 id="事务隔离级别"><a href="#事务隔离级别" class="headerlink" title="事务隔离级别"></a>事务隔离级别</h4><p>SQL 标准定义了四个隔离级别：</p>
<ul>
<li>READ-UNCOMMITTED(读取未提交)： 最低的隔离级别，允许读取尚未提交的数据变更，可能会导致脏读、幻读或不可重复读。</li>
<li>READ-COMMITTED(读取已提交)： 允许读取并发事务已经提交的数据，可以阻止脏读，但是幻读或不可重复读仍有可能发生。</li>
<li>REPEATABLE-READ(可重复读)： 对同一字段的多次读取结果都是一致的，除非数据是被本身事务自己所修改，可以阻止脏读和不可重复读，但幻读仍有可能发生。</li>
<li>SERIALIZABLE(可串行化)： 最高的隔离级别，完全服从ACID的隔离级别。所有的事务依次逐个执行，这样事务之间就完全不可能产生干扰，也就是说，该级别可以防止脏读、不可重复读以及幻读。</li>
</ul>
<p><code>MySQL InnoDB</code> 存储引擎的默认支持的隔离级别是 REPEATABLE-READ（可重读）。我们可以通过SELECT @@tx_isolation;命令来查看,MySQL 8.0 该命令改为SELECT @@transaction_isolation;</p>
<blockquote>
<p>在 MySQL 命令行的默认设置下，事务都是自动提交的，即执行 SQL 语句后就会马上执行 COMMIT 操作。因此要显式地开启一个事务务须使用命令 BEGIN 或 START TRANSACTION，或者执行命令 SET AUTOCOMMIT=0，用来禁止使用当前会话的自动提交</p>
</blockquote>
<p>2.事务处理控制语句：</p>
<ul>
<li>开始一个事务： BEGIN  TARNSACTION  事务名</li>
<li>提交一个事务： COMMIT TRAN 事务名</li>
<li>回滚一个事务： ROLLBACK TRAN 事务名</li>
</ul>
<p>在数据库应用程序设计中 , 事务控制语句一般用法是 :</p>
<ul>
<li>第 1 步: BEGIN TRAN 事务名；</li>
<li>第 2 步: 对数据库进行增、删、改等操作；</li>
<li>第 3 步：提交事务或回滚。 基本逻辑是，如果没有发生异常情况，则通过 <code>COMMIT</code> 语<br>句提交事务，确认第 2 步的操作；否则执行 <code>ROLLBACK</code> 回滚命令，撤消第 2 步的所有操作。</li>
</ul>
<p><strong>例:</strong> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE 教学管理;</span><br><span class="line">SELECT * INTO 学生表 1 FROM 学生表</span><br><span class="line">BEGIN TRAN </span><br><span class="line">UPDATE 学生表 1 SET 年龄 &#x3D;年龄 +1 </span><br><span class="line">DELETE FROM 学生表 1 WHERE 年龄 &gt;20 </span><br><span class="line">COMMIT TRAN </span><br><span class="line">GO </span><br><span class="line">DROP TABLE 学生表 1</span><br></pre></td></tr></table></figure>
<p>事务中包括两条语句，对学生表年龄进行修改后，再删除学生表中年龄大于 20 岁的<br>记录，这两条语句要么都执行，要么都不执行</p>
<h2 id="MySQL-ALTER命令"><a href="#MySQL-ALTER命令" class="headerlink" title="MySQL ALTER命令"></a>MySQL ALTER命令</h2><h3 id="删除，添加或修改表字段"><a href="#删除，添加或修改表字段" class="headerlink" title="删除，添加或修改表字段"></a>删除，添加或修改表字段</h3><p>使用了 ALTER 命令及 DROP 子句来删除以上创建表的 i 字段：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE testalter_tbl  DROP i;</span><br></pre></td></tr></table></figure>
<p>使用 ADD 子句来向数据表中添加列，如下实例在表 testalter_tbl 中添加 i 字段，并定义数据类型:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE testalter_tbl ADD i INT;</span><br></pre></td></tr></table></figure>
<h3 id="修改字段类型及名称"><a href="#修改字段类型及名称" class="headerlink" title="修改字段类型及名称"></a>修改字段类型及名称</h3><p>ALTER命令中使用 MODIFY 或 CHANGE 子句进行修改字段类型及名称</p>
<p>例如，把字段 c 的类型从 CHAR(1) 改为 CHAR(10)，可以执行以下命令:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE testalter_tbl MODIFY c CHAR(10);</span><br></pre></td></tr></table></figure>
<p>使用 CHANGE 子句, 语法有很大的不同。 在 CHANGE 关键字之后，紧跟着的是你要修改的字段名，然后指定新字段名及类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE testalter_tbl CHANGE i j BIGINT;</span><br></pre></td></tr></table></figure>
<h3 id="ALTER-TABLE-对-Null-值和默认值的影响"><a href="#ALTER-TABLE-对-Null-值和默认值的影响" class="headerlink" title="ALTER TABLE 对 Null 值和默认值的影响"></a>ALTER TABLE 对 Null 值和默认值的影响</h3><p>当你修改字段时，你可以指定是否包含值或者是否设置默认值。如,指定字段 j 为 NOT NULL 且默认值为100 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE testalter_tbl MODIFY j BIGINT NOT NULL DEFAULT 100;</span><br></pre></td></tr></table></figure>
<h3 id="修改字段默认值"><a href="#修改字段默认值" class="headerlink" title="修改字段默认值"></a>修改字段默认值</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE testalter_tbl ALTER i SET DEFAULT 1000;</span><br><span class="line"></span><br><span class="line">#ALTER 命令及 DROP子句来删除字段的默认值，</span><br><span class="line">ALTER TABLE testalter_tbl ALTER i DROP DEFAULT;</span><br></pre></td></tr></table></figure>
<h3 id="修改表名"><a href="#修改表名" class="headerlink" title="修改表名"></a>修改表名</h3><p>修改数据表的名称使用ALTER TABLE 语句中使用 RENAME 子句来实现。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE testalter_tbl RENAME TO alter_tbl;</span><br></pre></td></tr></table></figure>

<h2 id="MySQL-临时表"><a href="#MySQL-临时表" class="headerlink" title="MySQL 临时表"></a>MySQL 临时表</h2><p>MySQL 临时表在我们需要保存一些临时数据时是非常有用的。临时表只在当前连接可见，当关闭连接时，Mysql会自动删除表并释放所有空间。</p>
<p><strong>实例</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#创建临时表</span><br><span class="line">CREATE TEMPORARY TABLE SalesSummary (</span><br><span class="line">     product_name VARCHAR(50) NOT NULL</span><br><span class="line">    , total_sales DECIMAL(12,2) NOT NULL DEFAULT 0.00</span><br><span class="line">    , avg_unit_price DECIMAL(7,2) NOT NULL DEFAULT 0.00</span><br><span class="line">    , total_units_sold INT UNSIGNED NOT NULL DEFAULT 0</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#添加一条记录</span><br><span class="line">INSERT INTO SalesSummary(product_name, total_sales, avg_unit_price, total_units_sold)</span><br><span class="line">  VALUES</span><br><span class="line">  (&#39;cucumber&#39;, 100.25, 90, 2);</span><br><span class="line"># 查询临时表 </span><br><span class="line">SELECT * FROM SalesSummary;</span><br><span class="line"></span><br><span class="line">+--------------+-------------+----------------+------------------+</span><br><span class="line">| product_name | total_sales | avg_unit_price | total_units_sold |</span><br><span class="line">+--------------+-------------+----------------+------------------+</span><br><span class="line">| cucumber     |      100.25 |          90.00 |                2 |</span><br><span class="line">+--------------+-------------+----------------+------------------+</span><br></pre></td></tr></table></figure>
<p>当你使用 SHOW TABLES命令显示数据表列表时，你将无法看到 SalesSummary表。如果你退出当前MySQL会话，再使用 SELECT命令来读取原先创建的临时表数据，那你会发现数据库中没有该表的存在，因为在你退出时该临时表已经被销毁了。</p>
<h2 id="MySQL-复制表"><a href="#MySQL-复制表" class="headerlink" title="MySQL 复制表"></a>MySQL 复制表</h2><p>第一、只复制表结构到新表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create table 新表 select * from 旧表 where 1&#x3D;2</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"></span><br><span class="line">create table 新表 like 旧表</span><br></pre></td></tr></table></figure>
<p>第二、复制表结构及数据到新表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create table 新表 select * from 旧表</span><br></pre></td></tr></table></figure>
<h2 id="MySQL-元数据"><a href="#MySQL-元数据" class="headerlink" title="MySQL 元数据"></a>MySQL 元数据</h2><table>
<thead>
<tr>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>SELECT VERSION( )</td>
<td>服务器版本信息</td>
</tr>
<tr>
<td>SELECT DATABASE( )</td>
<td>当前数据库名 (或者返回空)</td>
</tr>
<tr>
<td>SELECT USER( )</td>
<td>当前用户名</td>
</tr>
<tr>
<td>SHOW STATUS</td>
<td>服务器状态</td>
</tr>
<tr>
<td>SHOW VARIABLES</td>
<td>服务器配置变量</td>
</tr>
</tbody></table>
<h2 id="MySQL-序列使用"><a href="#MySQL-序列使用" class="headerlink" title="MySQL 序列使用"></a>MySQL 序列使用</h2><p>MySQL 序列是一组整数：1, 2, 3, …，由于一张数据表只能有一个字段自增主键， 如果你想实现其他字段也实现自动增加，就可以使用MySQL序列来实现。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE insect</span><br><span class="line">    (</span><br><span class="line">    id INT UNSIGNED NOT NULL AUTO_INCREMENT,</span><br><span class="line">    PRIMARY KEY (id),</span><br><span class="line">    name VARCHAR(30) NOT NULL, # type of insect</span><br><span class="line">    date DATE NOT NULL, # date collected</span><br><span class="line">    origin VARCHAR(30) NOT NULL # where collected</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="重置序列"><a href="#重置序列" class="headerlink" title="重置序列"></a>重置序列</h3><p>可以通过删除自增的列，然后重新添加来实现。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE insect DROP id;</span><br><span class="line">mysql&gt; ALTER TABLE insect</span><br><span class="line">    ADD id INT UNSIGNED NOT NULL AUTO_INCREMENT FIRST,</span><br><span class="line">    ADD PRIMARY KEY (id);</span><br></pre></td></tr></table></figure>
<h3 id="设置序列的开始值"><a href="#设置序列的开始值" class="headerlink" title="设置序列的开始值"></a>设置序列的开始值</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE TABLE insect</span><br><span class="line">    -&gt; (</span><br><span class="line">    -&gt; id INT UNSIGNED NOT NULL AUTO_INCREMENT,</span><br><span class="line">    -&gt; PRIMARY KEY (id),</span><br><span class="line">    -&gt; name VARCHAR(30) NOT NULL, </span><br><span class="line">    -&gt; date DATE NOT NULL,</span><br><span class="line">    -&gt; origin VARCHAR(30) NOT NULL</span><br><span class="line">)engine&#x3D;innodb auto_increment&#x3D;100 charset&#x3D;utf8;</span><br></pre></td></tr></table></figure>
<p>或者你也可以在表创建成功后</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE t AUTO_INCREMENT &#x3D; 100;</span><br></pre></td></tr></table></figure></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">三月三</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://zysheep.cn/2018/05/07/MySQL/45/">https://zysheep.cn/2018/05/07/MySQL/45/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://zysheep.cn" target="_blank">三月三</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a></div><div class="post_share"><div class="social-share" data-image="http://cdn.panyucable.cn/zysheep/flask_cover.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="https://cdn.jsdelivr.net/gh/zysheep/picgo-imgs/imgwechat.png" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="https://cdn.jsdelivr.net/gh/zysheep/picgo-imgs/imgalipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2018/05/08/SimpleApp/Maven/53/"><img class="prev_cover" src="http://cdn.panyucable.cn/zysheep/Maven.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Maven 简介</div></div></a></div><div class="next-post pull_right"><a href="/2018/05/07/SimpleApp/Intellij%20%20IDEA/46/"><img class="next_cover" src="http://cdn.panyucable.cn/zysheep/Intellij_IDEA_logo.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Intellij IDEA安装和使用</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2018/05/06/MySQL/44/" title="MySQL安装"><img class="relatedPosts_cover" src="http://cdn.panyucable.cn/zysheep/mysql_PNG32.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2018-05-06</div><div class="relatedPosts_title">MySQL安装</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: '502b8308721b081071a5',
  clientSecret: '35220d15c7f8aaf585d6822cf5d49fedf5b602d6',
  repo: 'blog-comment',
  owner: 'zysheep',
  admin: ['zysheep'],
  id: md5(decodeURI(location.pathname)),
  language: 'zh-CN',
  perPage: 10,
  distractionFreeMode: false,
  pagerDirection: 'last',
  createIssueManually: false,
  updateCountCallback: commentCount
})
gitalk.render('gitalk-container')

function commentCount(n){
  try {
    document.getElementsByClassName('gitalk-comment-count')[0].innerHTML= n
  } catch (e) {
    return false
  }
}</script></div></article></main><footer id="footer" style="background-image: url(http://cdn.panyucable.cn/zysheep/mysql_PNG32.png)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 三月三</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text"><a href="http://zysheep.github.io/" target="_blank" rel="noopener">三月三</a>,专门为你制造快乐的网站</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/third-party/click_heart.js"></script><script src="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@master/Hexo/js/hideCategory.min.js"></script><script>var endLoading = function () {
  document.body.style.overflow = 'auto';
  document.getElementById('loading-box').classList.add("loaded")
}
window.addEventListener('load',endLoading)</script></body></html>