<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>ElasticSearch面试题 | 三月三</title><meta name="description" content="ElasticSearch面试题前言ElasticSearch是一个基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java语言开发的，并作为Apache许可条款下的开放源码发布，是一种流行的企业级搜索引擎。ElasticSearch用于云计算中，能够达到实时搜索，稳定，可靠，快速，安装使用方便。官方客户端在J"><meta name="keywords" content="面试宝典"><meta name="author" content="三月三"><meta name="copyright" content="三月三"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="http://cdn.panyucable.cn/zysheep/ico.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://hm.baidu.com"/><link rel="dns-prefetch" href="https://hm.baidu.com"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="ElasticSearch面试题"><meta name="twitter:description" content="ElasticSearch面试题前言ElasticSearch是一个基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java语言开发的，并作为Apache许可条款下的开放源码发布，是一种流行的企业级搜索引擎。ElasticSearch用于云计算中，能够达到实时搜索，稳定，可靠，快速，安装使用方便。官方客户端在J"><meta name="twitter:image" content="http://cdn.panyucable.cn/zysheep/es-1.png"><meta property="og:type" content="article"><meta property="og:title" content="ElasticSearch面试题"><meta property="og:url" content="https://zysheep.cn/2020/03/03/interview/ElasticSearch%E9%9D%A2%E8%AF%95%E9%A2%98/"><meta property="og:site_name" content="三月三"><meta property="og:description" content="ElasticSearch面试题前言ElasticSearch是一个基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java语言开发的，并作为Apache许可条款下的开放源码发布，是一种流行的企业级搜索引擎。ElasticSearch用于云计算中，能够达到实时搜索，稳定，可靠，快速，安装使用方便。官方客户端在J"><meta property="og:image" content="http://cdn.panyucable.cn/zysheep/es-1.png"><meta property="article:published_time" content="2020-03-02T16:00:00.000Z"><meta property="article:modified_time" content="2020-06-29T09:37:47.727Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="https://zysheep.cn/2020/03/03/interview/ElasticSearch%E9%9D%A2%E8%AF%95%E9%A2%98/"><link rel="prev" title="JVM与调优面试题" href="https://zysheep.cn/2020/03/03/interview/JVM%E4%B8%8E%E8%B0%83%E4%BC%98%E9%9D%A2%E8%AF%95%E9%A2%98/"><link rel="next" title="Java 面试题（二）" href="https://zysheep.cn/2020/03/03/interview/Java%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98(%E4%BA%8C)/"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5/js/md5.min.js"></script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7f671f0f6d996680d21d5c32a23a9313";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://zysheep.github.io/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: true,
  fancybox: false,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: true,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@master/Hexo/css/hideCategory.min.css"><meta name="generator" content="Hexo 4.2.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="http://cdn.panyucable.cn/zysheep/xiaoman.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">213</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">50</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">71</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-bug" aria-hidden="true"></i><span> 编程路线</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/java/"><i class="fa-fw fa fa-coffee"></i><span> Java</span></a></li><li><a class="site-page" href="/python/"><i class="fa-fw fa fa-binoculars"></i><span> Python</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-folder-open" aria-hidden="true"></i><span> 面试宝典</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/interview/"><i class="fa-fw fa fa-file-text-o"></i><span> Java面试题</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 我的生活</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/gallery/"><i class="fa-fw fa fa-picture-o"></i><span> Gallery</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ElasticSearch面试题"><span class="toc-number">1.</span> <span class="toc-text">ElasticSearch面试题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-number">1.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Elasticsearch-面试题"><span class="toc-number">1.2.</span> <span class="toc-text">Elasticsearch 面试题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1、elasticsearch-了解多少，说说你们公司-es-的集群架构，索引数据大小，分片有多少，以及一些调优手段-。"><span class="toc-number">1.3.</span> <span class="toc-text">1、elasticsearch 了解多少，说说你们公司 es 的集群架构，索引数据大小，分片有多少，以及一些调优手段 。</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1、设计阶段调优"><span class="toc-number">1.3.1.</span> <span class="toc-text">1.1、设计阶段调优</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2、写入调优"><span class="toc-number">1.3.2.</span> <span class="toc-text">1.2、写入调优</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3、查询调优"><span class="toc-number">1.3.3.</span> <span class="toc-text">1.3、查询调优</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4、其他调优"><span class="toc-number">1.3.4.</span> <span class="toc-text">1.4、其他调优</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、elasticsearch-的倒排索引是什么"><span class="toc-number">1.4.</span> <span class="toc-text">2、elasticsearch 的倒排索引是什么</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、elasticsearch-索引数据多了怎么办，如何调优，部署"><span class="toc-number">1.5.</span> <span class="toc-text">3、elasticsearch 索引数据多了怎么办，如何调优，部署</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-动态索引层面"><span class="toc-number">1.5.1.</span> <span class="toc-text">3.1 动态索引层面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-存储层面"><span class="toc-number">1.5.2.</span> <span class="toc-text">3.2 存储层面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-部署层面"><span class="toc-number">1.5.3.</span> <span class="toc-text">3.3 部署层面</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、elasticsearch-是如何实现-master-选举的"><span class="toc-number">1.6.</span> <span class="toc-text">4、elasticsearch 是如何实现 master 选举的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5、详细描述一下-Elasticsearch-索引文档的过程"><span class="toc-number">1.7.</span> <span class="toc-text">5、详细描述一下 Elasticsearch 索引文档的过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6、详细描述一下-Elasticsearch-搜索的过程？"><span class="toc-number">1.8.</span> <span class="toc-text">6、详细描述一下 Elasticsearch 搜索的过程？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7、Elasticsearch-在部署时，对-Linux-的设置有哪些优化方法"><span class="toc-number">1.9.</span> <span class="toc-text">7、Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8、lucence-内部结构是什么？"><span class="toc-number">1.10.</span> <span class="toc-text">8、lucence 内部结构是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9、Elasticsearch-是如何实现-Master-选举的？"><span class="toc-number">1.11.</span> <span class="toc-text">9、Elasticsearch 是如何实现 Master 选举的？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10、Elasticsearch-中的节点（比如共-20-个），其中的-10-个"><span class="toc-number">1.12.</span> <span class="toc-text">10、Elasticsearch 中的节点（比如共 20 个），其中的 10 个</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11、客户端在和集群连接时，如何选择特定的节点执行请求的？"><span class="toc-number">1.13.</span> <span class="toc-text">11、客户端在和集群连接时，如何选择特定的节点执行请求的？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12、详细描述一下-Elasticsearch-索引文档的过程。"><span class="toc-number">1.14.</span> <span class="toc-text">12、详细描述一下 Elasticsearch 索引文档的过程。</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(http://cdn.panyucable.cn/zysheep/es_logo.jfif)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">三月三</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-bug" aria-hidden="true"></i><span> 编程路线</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/java/"><i class="fa-fw fa fa-coffee"></i><span> Java</span></a></li><li><a class="site-page" href="/python/"><i class="fa-fw fa fa-binoculars"></i><span> Python</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-folder-open" aria-hidden="true"></i><span> 面试宝典</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/interview/"><i class="fa-fw fa fa-file-text-o"></i><span> Java面试题</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 我的生活</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/gallery/"><i class="fa-fw fa fa-picture-o"></i><span> Gallery</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">ElasticSearch面试题</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-03-03 00:00:00"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-03-03</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-06-29 17:37:47"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-06-29</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E9%9D%A2%E8%AF%95%E5%AE%9D%E5%85%B8/">面试宝典</a><i class="fa fa-angle-right post-meta__separator" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E9%9D%A2%E8%AF%95%E5%AE%9D%E5%85%B8/ElasticSearch%E9%9D%A2%E8%AF%95%E9%A2%98/">ElasticSearch面试题</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">3.5k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 11 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-comment-o" aria-hidden="true"></i><span>评论数:</span><a href="/2020/03/03/interview/ElasticSearch%E9%9D%A2%E8%AF%95%E9%A2%98/#post-comment"><span class="gitalk-comment-count comment-count"></span></a></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="ElasticSearch面试题"><a href="#ElasticSearch面试题" class="headerlink" title="ElasticSearch面试题"></a>ElasticSearch面试题</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>ElasticSearch是一个基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java语言开发的，并作为Apache许可条款下的开放源码发布，是一种流行的企业级搜索引擎。ElasticSearch用于云计算中，能够达到实时搜索，稳定，可靠，快速，安装使用方便。官方客户端在Java、.NET（C#）、PHP、Python、Apache Groovy、Ruby和许多其他语言中都是可用的。根据DB-Engines的排名显示，Elasticsearch是最受欢迎的企业搜索引擎，其次是Apache Solr，也是基于Lucene。</p>
<h2 id="Elasticsearch-面试题"><a href="#Elasticsearch-面试题" class="headerlink" title="Elasticsearch 面试题"></a>Elasticsearch 面试题</h2><p>1、elasticsearch 了解多少，说说你们公司 es 的集群架构，索引数据大小，分片有多少，以及一些调优手段 。</p>
<p>2、elasticsearch 的倒排索引是什么</p>
<p>3、elasticsearch 索引数据多了怎么办，如何调优，部署</p>
<p>4、elasticsearch 是如何实现 master 选举的</p>
<p>5、详细描述一下 Elasticsearch 索引文档的过程</p>
<p>6、详细描述一下 Elasticsearch 搜索的过程？</p>
<p>7、Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法</p>
<p>8、lucence 内部结构是什么？</p>
<p>9、Elasticsearch 是如何实现 Master 选举的？</p>
<p>10、Elasticsearch 中的节点（比如共 20 个），其中的 10 个选了一个master，另外 10 个选了另一个 master，怎么办？</p>
<p>11、客户端在和集群连接时，如何选择特定的节点执行请求的？</p>
<p>12、详细描述一下 Elasticsearch 索引文档的过程。</p>
<h2 id="1、elasticsearch-了解多少，说说你们公司-es-的集群架构，索引数据大小，分片有多少，以及一些调优手段-。"><a href="#1、elasticsearch-了解多少，说说你们公司-es-的集群架构，索引数据大小，分片有多少，以及一些调优手段-。" class="headerlink" title="1、elasticsearch 了解多少，说说你们公司 es 的集群架构，索引数据大小，分片有多少，以及一些调优手段 。"></a>1、elasticsearch 了解多少，说说你们公司 es 的集群架构，索引数据大小，分片有多少，以及一些调优手段 。</h2><p>面试官：想了解应聘者之前公司接触的 ES 使用场景、规模，有没有做过比较大规模的索引设计、规划、调优。</p>
<p>解答：如实结合自己的实践场景回答即可。</p>
<p>比如：ES 集群架构 13 个节点，索引根据通道不同共 20+索引，根据日期，每日递增 20+，索引：10 分片，每日递增 1 亿+数据，每个通道每天索引大小控制：150GB 之内。</p>
<p>仅索引层面调优手段：</p>
<h3 id="1-1、设计阶段调优"><a href="#1-1、设计阶段调优" class="headerlink" title="1.1、设计阶段调优"></a>1.1、设计阶段调优</h3><p>（1）根据业务增量需求，采取基于日期模板创建索引，通过 roll over API 滚动索引；</p>
<p>（2）使用别名进行索引管理；</p>
<p>（3）每天凌晨定时对索引做 force_merge 操作，以释放空间；</p>
<p>（4）采取冷热分离机制，热数据存储到 SSD，提高检索效率；冷数据定期进行 shrink操作，以缩减存储；</p>
<p>（5）采取 curator 进行索引的生命周期管理；</p>
<p>（6）仅针对需要分词的字段，合理的设置分词器；</p>
<p>（7）Mapping 阶段充分结合各个字段的属性，是否需要检索、是否需要存储等。……..</p>
<h3 id="1-2、写入调优"><a href="#1-2、写入调优" class="headerlink" title="1.2、写入调优"></a>1.2、写入调优</h3><p>（1）写入前副本数设置为 0；</p>
<p>（2）写入前关闭 refresh_interval 设置为-1，禁用刷新机制；</p>
<p>（3）写入过程中：采取 bulk 批量写入；</p>
<p>（4）写入后恢复副本数和刷新间隔；</p>
<p>（5）尽量使用自动生成的 id。</p>
<h3 id="1-3、查询调优"><a href="#1-3、查询调优" class="headerlink" title="1.3、查询调优"></a>1.3、查询调优</h3><p>（1）禁用 wildcard；</p>
<p>（2）禁用批量 terms（成百上千的场景）；</p>
<p>（3）充分利用倒排索引机制，能 keyword 类型尽量 keyword；</p>
<p>（4）数据量大时候，可以先基于时间敲定索引再检索；</p>
<p>（5）设置合理的路由机制。</p>
<h3 id="1-4、其他调优"><a href="#1-4、其他调优" class="headerlink" title="1.4、其他调优"></a>1.4、其他调优</h3><p>部署调优，业务调优等。</p>
<p>上面的提及一部分，面试者就基本对你之前的实践或者运维经验有所评估了。</p>
<h2 id="2、elasticsearch-的倒排索引是什么"><a href="#2、elasticsearch-的倒排索引是什么" class="headerlink" title="2、elasticsearch 的倒排索引是什么"></a>2、elasticsearch 的倒排索引是什么</h2><p>面试官：想了解你对基础概念的认知。</p>
<p>解答：通俗解释一下就可以。</p>
<p>传统的我们的检索是通过文章，逐个遍历找到对应关键词的位置。</p>
<p>而倒排索引，是通过分词策略，形成了词和文章的映射关系表，这种词典+映射表即为倒排索引。有了倒排索引，就能实现 o（1）时间复杂度的效率检索文章了，极大的提高了检索效率。</p>
<p><img src="http://cdn.panyucable.cn/zysheep/16f3cd47d11e0d11.jpg" alt=""></p>
<p>学术的解答方式：</p>
<p>倒排索引，相反于一篇文章包含了哪些词，它从词出发，记载了这个词在哪些文档中出现过，由两部分组成——词典和倒排表。</p>
<p>加分项：倒排索引的底层实现是基于：FST（Finite State Transducer）数据结构。</p>
<p>lucene 从 4+版本后开始大量使用的数据结构是 FST。FST 有两个优点：</p>
<p>（1）空间占用小。通过对词典中单词前缀和后缀的重复利用，压缩了存储空间；</p>
<p>（2）查询速度快。O(len(str))的查询时间复杂度。</p>
<h2 id="3、elasticsearch-索引数据多了怎么办，如何调优，部署"><a href="#3、elasticsearch-索引数据多了怎么办，如何调优，部署" class="headerlink" title="3、elasticsearch 索引数据多了怎么办，如何调优，部署"></a>3、elasticsearch 索引数据多了怎么办，如何调优，部署</h2><p>面试官：想了解大数据量的运维能力。</p>
<p>解答：索引数据的规划，应在前期做好规划，正所谓“设计先行，编码在后”，这样才能有效的避免突如其来的数据激增导致集群处理能力不足引发的线上客户检索或者其他业务受到影响。</p>
<p>如何调优，正如问题 1 所说，这里细化一下：</p>
<h3 id="3-1-动态索引层面"><a href="#3-1-动态索引层面" class="headerlink" title="3.1 动态索引层面"></a>3.1 动态索引层面</h3><p>基于模板+时间+rollover api 滚动创建索引，举例：设计阶段定义：blog 索引的模板格式为：blog_index_时间戳的形式，每天递增数据。这样做的好处：不至于数据量激增导致单个索引数据量非常大，接近于上线 2 的32 次幂-1，索引存储达到了 TB+甚至更大。</p>
<p>一旦单个索引很大，存储等各种风险也随之而来，所以要提前考虑+及早避免。</p>
<h3 id="3-2-存储层面"><a href="#3-2-存储层面" class="headerlink" title="3.2 存储层面"></a>3.2 存储层面</h3><p>冷热数据分离存储，热数据（比如最近 3 天或者一周的数据），其余为冷数据。</p>
<p>对于冷数据不会再写入新数据，可以考虑定期 force_merge 加 shrink 压缩操作，节省存储空间和检索效率。</p>
<h3 id="3-3-部署层面"><a href="#3-3-部署层面" class="headerlink" title="3.3 部署层面"></a>3.3 部署层面</h3><p>一旦之前没有规划，这里就属于应急策略。</p>
<p>结合 ES 自身的支持动态扩展的特点，动态新增机器的方式可以缓解集群压力，注意：如果之前主节点等规划合理，不需要重启集群也能完成动态新增的。</p>
<h2 id="4、elasticsearch-是如何实现-master-选举的"><a href="#4、elasticsearch-是如何实现-master-选举的" class="headerlink" title="4、elasticsearch 是如何实现 master 选举的"></a>4、elasticsearch 是如何实现 master 选举的</h2><p>面试官：想了解 ES 集群的底层原理，不再只关注业务层面了。</p>
<p>解答：</p>
<p>前置前提：</p>
<p>（1）只有候选主节点（master：true）的节点才能成为主节点。</p>
<p>（2）最小主节点数（min_master_nodes）的目的是防止脑裂。</p>
<p>核对了一下代码，核心入口为 findMaster，选择主节点成功返回对应 Master，否则返回 null。选举流程大致描述如下：</p>
<p>第一步：确认候选主节点数达标，elasticsearch.yml 设置的值</p>
<p>discovery.zen.minimum_master_nodes；</p>
<p>第二步：比较：先判定是否具备 master 资格，具备候选主节点资格的优先返回；</p>
<p>若两节点都为候选主节点，则 id 小的值会主节点。注意这里的 id 为 string 类型。</p>
<p>题外话：获取节点 id 的方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1GET &#x2F;_cat&#x2F;nodes?v&amp;h&#x3D;ip,port,heapPercent,heapMax,id,name</span><br><span class="line"></span><br><span class="line">2ip port heapPercent heapMax id name</span><br></pre></td></tr></table></figure>

<h2 id="5、详细描述一下-Elasticsearch-索引文档的过程"><a href="#5、详细描述一下-Elasticsearch-索引文档的过程" class="headerlink" title="5、详细描述一下 Elasticsearch 索引文档的过程"></a>5、详细描述一下 Elasticsearch 索引文档的过程</h2><p>面试官：想了解 ES 的底层原理，不再只关注业务层面了。</p>
<p>解答：</p>
<p>这里的索引文档应该理解为文档写入 ES，创建索引的过程。</p>
<p>文档写入包含：单文档写入和批量 bulk 写入，这里只解释一下：单文档写入流程。</p>
<p>记住官方文档中的这个图。</p>
<p><img src="http://cdn.panyucable.cn/zysheep/16f3cd47d2b0df73.jpg" alt=""></p>
<p>第一步：客户写集群某节点写入数据，发送请求。（如果没有指定路由/协调节点，请求的节点扮演路由节点的角色。）</p>
<p>第二步：节点 1 接受到请求后，使用文档_id 来确定文档属于分片 0。请求会被转到另外的节点，假定节点 3。因此分片 0 的主分片分配到节点 3 上。</p>
<p>第三步：节点 3 在主分片上执行写操作，如果成功，则将请求并行转发到节点 1和节点 2 的副本分片上，等待结果返回。所有的副本分片都报告成功，节点 3 将向协调节点（节点 1）报告成功，节点 1 向请求客户端报告写入成功。</p>
<p>如果面试官再问：第二步中的文档获取分片的过程？</p>
<p>回答：借助路由算法获取，路由算法就是根据路由和文档 id 计算目标的分片 id 的过程。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1shard &#x3D; hash(_routing) % (num_of_primary_shards)</span><br></pre></td></tr></table></figure>



<h2 id="6、详细描述一下-Elasticsearch-搜索的过程？"><a href="#6、详细描述一下-Elasticsearch-搜索的过程？" class="headerlink" title="6、详细描述一下 Elasticsearch 搜索的过程？"></a>6、详细描述一下 Elasticsearch 搜索的过程？</h2><p>面试官：想了解 ES 搜索的底层原理，不再只关注业务层面了。</p>
<p>解答：</p>
<p>搜索拆解为“query then fetch” 两个阶段。</p>
<p>query 阶段的目的：定位到位置，但不取。</p>
<p>步骤拆解如下：</p>
<p>（1）假设一个索引数据有 5 主+1 副本 共 10 分片，一次请求会命中（主或者副本分片中）的一个。</p>
<p>（2）每个分片在本地进行查询，结果返回到本地有序的优先队列中。</p>
<p>（3）第 2）步骤的结果发送到协调节点，协调节点产生一个全局的排序列表。</p>
<p>fetch 阶段的目的：取数据。</p>
<p>路由节点获取所有文档，返回给客户端。</p>
<h2 id="7、Elasticsearch-在部署时，对-Linux-的设置有哪些优化方法"><a href="#7、Elasticsearch-在部署时，对-Linux-的设置有哪些优化方法" class="headerlink" title="7、Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法"></a>7、Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法</h2><p>面试官：想了解对 ES 集群的运维能力。</p>
<p>解答：</p>
<p>（1）关闭缓存 swap;</p>
<p>（2）堆内存设置为：Min（节点内存/2, 32GB）;</p>
<p>（3）设置最大文件句柄数；</p>
<p>（4）线程池+队列大小根据业务需要做调整；</p>
<p>（5）磁盘存储 raid 方式——存储有条件使用 RAID10，增加单节点性能以及避免单节点存储故障。</p>
<h2 id="8、lucence-内部结构是什么？"><a href="#8、lucence-内部结构是什么？" class="headerlink" title="8、lucence 内部结构是什么？"></a>8、lucence 内部结构是什么？</h2><p>面试官：想了解你的知识面的广度和深度。</p>
<p>解答：</p>
<p><img src="http://cdn.panyucable.cn/zysheep/16f3cd47d3590ee5.jpg" alt=""></p>
<p>Lucene 是有索引和搜索的两个过程，包含索引创建，索引，搜索三个要点。可以基于这个脉络展开一些。</p>
<h2 id="9、Elasticsearch-是如何实现-Master-选举的？"><a href="#9、Elasticsearch-是如何实现-Master-选举的？" class="headerlink" title="9、Elasticsearch 是如何实现 Master 选举的？"></a>9、Elasticsearch 是如何实现 Master 选举的？</h2><p>（1）Elasticsearch 的选主是 ZenDiscovery 模块负责的，主要包含 Ping（节点之间通过这个 RPC 来发现彼此）和 Unicast（单播模块包含一个主机列表以控制哪些节点需要 ping 通）这两部分；</p>
<p>（2）对所有可以成为 master 的节点（node.master: true）根据 nodeId 字典排序，每次选举每个节点都把自己所知道节点排一次序，然后选出第一个（第 0 位）节点，暂且认为它是 master 节点。</p>
<p>（3）如果对某个节点的投票数达到一定的值（可以成为 master 节点数 n/2+1）并且该节点自己也选举自己，那这个节点就是 master。否则重新选举一直到满足上述条件。</p>
<p>（4）补充：master 节点的职责主要包括集群、节点和索引的管理，不负责文档级别的管理；data 节点可以关闭 http 功能*。</p>
<h2 id="10、Elasticsearch-中的节点（比如共-20-个），其中的-10-个"><a href="#10、Elasticsearch-中的节点（比如共-20-个），其中的-10-个" class="headerlink" title="10、Elasticsearch 中的节点（比如共 20 个），其中的 10 个"></a>10、Elasticsearch 中的节点（比如共 20 个），其中的 10 个</h2><p>选了一个 master，另外 10 个选了另一个 master，怎么办？</p>
<p>（1）当集群 master 候选数量不小于 3 个时，可以通过设置最少投票通过数量（discovery.zen.minimum_master_nodes）超过所有候选节点一半以上来解决脑裂问题；</p>
<p>（3）当候选数量为两个时，只能修改为唯一的一个 master 候选，其他作为 data节点，避免脑裂问题。</p>
<h2 id="11、客户端在和集群连接时，如何选择特定的节点执行请求的？"><a href="#11、客户端在和集群连接时，如何选择特定的节点执行请求的？" class="headerlink" title="11、客户端在和集群连接时，如何选择特定的节点执行请求的？"></a>11、客户端在和集群连接时，如何选择特定的节点执行请求的？</h2><p>TransportClient 利用 transport 模块远程连接一个 elasticsearch 集群。它并不加入到集群中，只是简单的获得一个或者多个初始化的 transport 地址，并以 轮询 的方式与这些地址进行通信。</p>
<h2 id="12、详细描述一下-Elasticsearch-索引文档的过程。"><a href="#12、详细描述一下-Elasticsearch-索引文档的过程。" class="headerlink" title="12、详细描述一下 Elasticsearch 索引文档的过程。"></a>12、详细描述一下 Elasticsearch 索引文档的过程。</h2><p>协调节点默认使用文档 ID 参与计算（也支持通过 routing），以便为路由提供合适的分片。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shard &#x3D; hash(document_id) % (num_of_primary_shards)</span><br></pre></td></tr></table></figure>

<p>（1）当分片所在的节点接收到来自协调节点的请求后，会将请求写入到 MemoryBuffer，然后定时（默认是每隔 1 秒）写入到 Filesystem Cache，这个从 MomeryBuffer 到 Filesystem Cache 的过程就叫做 refresh；</p>
<p>（2）当然在某些情况下，存在 Momery Buffer 和 Filesystem Cache 的数据可能会丢失，ES 是通过 translog 的机制来保证数据的可靠性的。其实现机制是接收到请求后，同时也会写入到 translog 中 ，当 Filesystem cache 中的数据写入到磁盘中时，才会清除掉，这个过程叫做 flush；</p>
<p>（3）在 flush 过程中，内存中的缓冲将被清除，内容被写入一个新段，段的 fsync将创建一个新的提交点，并将内容刷新到磁盘，旧的 translog 将被删除并开始一个新的 translog。</p>
<p>（4）flush 触发的时机是定时触发（默认 30 分钟）或者 translog 变得太大（默认为 512M）时；</p>
<p><img src="http://cdn.panyucable.cn/zysheep/16f3cd48799304d6.jpg" alt=""></p>
<p>补充：关于 Lucene 的 Segement：</p>
<p>（1）Lucene 索引是由多个段组成，段本身是一个功能齐全的倒排索引。</p>
<p>（2）段是不可变的，允许 Lucene 将新的文档增量地添加到索引中，而不用从头重建索引。</p>
<p>（3）对于每一个搜索请求而言，索引中的所有段都会被搜索，并且每个段会消耗CPU 的时钟周、文件句柄和内存。这意味着段的数量越多，搜索性能会越低。</p>
<p>（4）为了解决这个问题，Elasticsearch 会合并小段到一个较大的段，提交新的合并段到磁盘，并删除那些旧的小段。</p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">三月三</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://zysheep.cn/2020/03/03/interview/ElasticSearch%E9%9D%A2%E8%AF%95%E9%A2%98/">https://zysheep.cn/2020/03/03/interview/ElasticSearch面试题/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://zysheep.cn" target="_blank">三月三</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%9D%A2%E8%AF%95%E5%AE%9D%E5%85%B8/">面试宝典</a></div><div class="post_share"><div class="social-share" data-image="http://cdn.panyucable.cn/zysheep/wallhaven-n673pw.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="https://cdn.jsdelivr.net/gh/zysheep/picgo-imgs/imgwechat.png" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="https://cdn.jsdelivr.net/gh/zysheep/picgo-imgs/imgalipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/03/03/interview/JVM%E4%B8%8E%E8%B0%83%E4%BC%98%E9%9D%A2%E8%AF%95%E9%A2%98/"><img class="prev_cover" src="http://cdn.panyucable.cn/zysheep/1536x1058.jfif" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">JVM与调优面试题</div></div></a></div><div class="next-post pull_right"><a href="/2020/03/03/interview/Java%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98(%E4%BA%8C)/"><img class="next_cover" src="http://cdn.panyucable.cn/zysheep/1536x1058.jfif" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Java 面试题（二）</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/03/03/interview/Dubbo面试题/" title="Dubbo面试题"><img class="relatedPosts_cover" src="http://cdn.panyucable.cn/zysheep/feature_maintenance.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-03</div><div class="relatedPosts_title">Dubbo面试题</div></div></a></div><div class="relatedPosts_item"><a href="/2020/03/03/interview/JVM与调优面试题/" title="JVM与调优面试题"><img class="relatedPosts_cover" src="http://cdn.panyucable.cn/zysheep/1536x1058.jfif"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-03</div><div class="relatedPosts_title">JVM与调优面试题</div></div></a></div><div class="relatedPosts_item"><a href="/2020/03/03/interview/Java基础面试题(二)/" title="Java 面试题（二）"><img class="relatedPosts_cover" src="http://cdn.panyucable.cn/zysheep/1536x1058.jfif"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-03</div><div class="relatedPosts_title">Java 面试题（二）</div></div></a></div><div class="relatedPosts_item"><a href="/2020/03/03/interview/Java并发编程面试题/" title="Java并发编程"><img class="relatedPosts_cover" src="http://cdn.panyucable.cn/zysheep/2026x1136.jfif"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-03</div><div class="relatedPosts_title">Java并发编程</div></div></a></div><div class="relatedPosts_item"><a href="/2020/03/03/interview/Java微服务面试题/" title="微服务面试题"><img class="relatedPosts_cover" src="http://cdn.panyucable.cn/zysheep/1768x1179.jfif"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-03</div><div class="relatedPosts_title">微服务面试题</div></div></a></div><div class="relatedPosts_item"><a href="/2020/03/03/interview/Linux面试题/" title="Linux面试题"><img class="relatedPosts_cover" src="http://cdn.panyucable.cn/zysheep/1791x1193.jfif"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-03</div><div class="relatedPosts_title">Linux面试题</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: '502b8308721b081071a5',
  clientSecret: '35220d15c7f8aaf585d6822cf5d49fedf5b602d6',
  repo: 'blog-comment',
  owner: 'zysheep',
  admin: ['zysheep'],
  id: md5(decodeURI(location.pathname)),
  language: 'zh-CN',
  perPage: 10,
  distractionFreeMode: false,
  pagerDirection: 'last',
  createIssueManually: false,
  updateCountCallback: commentCount
})
gitalk.render('gitalk-container')

function commentCount(n){
  try {
    document.getElementsByClassName('gitalk-comment-count')[0].innerHTML= n
  } catch (e) {
    return false
  }
}</script></div></article></main><footer id="footer" style="background-image: url(http://cdn.panyucable.cn/zysheep/es_logo.jfif)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 三月三</div><div class="footer_custom_text">生活不只是眼前的苟且,还有诗和远方</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/third-party/click_heart.js"></script><script src="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@master/Hexo/js/hideCategory.min.js"></script><script>var endLoading = function () {
  document.body.style.overflow = 'auto';
  document.getElementById('loading-box').classList.add("loaded")
}
window.addEventListener('load',endLoading)</script></body></html>